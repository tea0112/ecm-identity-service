# ============================================================
# ECM Identity Service - Main Configuration
# ============================================================
# All values externalized via environment variables.
# Defaults are safe for CI/CD (no secrets, production-safe).
# ============================================================

spring.application.name=ecm-identity-service

# ------------------------------------------------------------
# DATABASE
# ------------------------------------------------------------
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# ------------------------------------------------------------
# SCHEMA
# ------------------------------------------------------------
spring.liquibase.default-schema=${DB_SCHEMA:public}
spring.jpa.properties.hibernate.default_schema=${DB_SCHEMA:public}

# ------------------------------------------------------------
# LIQUIBASE
# ------------------------------------------------------------
spring.liquibase.enabled=true
spring.liquibase.change-log=classpath:db/changelog/db.changelog-master.xml
spring.liquibase.contexts=${LIQUIBASE_CONTEXTS:prod}

# ------------------------------------------------------------
# JPA / HIBERNATE
# ------------------------------------------------------------
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=${JPA_SHOW_SQL:false}
spring.jpa.properties.hibernate.format_sql=${JPA_FORMAT_SQL:false}

# ------------------------------------------------------------
# LOGGING
# ------------------------------------------------------------
logging.level.root=${LOG_LEVEL_ROOT:INFO}
logging.level.liquibase=${LOG_LEVEL_LIQUIBASE:WARN}
logging.level.com.ecm.security=${LOG_LEVEL_APP:INFO}

# ------------------------------------------------------------
# SECURITY BOOTSTRAP
# ------------------------------------------------------------
app.security.admin.initial-password=${ADMIN_INITIAL_PASSWORD:}
app.security.admin.email=${ADMIN_EMAIL:admin@company.com}

# ------------------------------------------------------------
# SERVER
# ------------------------------------------------------------
server.port=${SERVER_PORT:8080}
server.error.include-message=${ERROR_INCLUDE_MESSAGE:never}
server.error.include-stacktrace=${ERROR_INCLUDE_STACKTRACE:never}

# ------------------------------------------------------------
# SPRINGDOC OPENAPI / SWAGGER
# ------------------------------------------------------------
# Enable/disable documentation (disable in production if needed)
springdoc.api-docs.enabled=${OPENAPI_ENABLED:true}
springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.enabled=${SWAGGER_UI_ENABLED:true}
springdoc.swagger-ui.path=/swagger-ui.html

# Swagger UI Customization
springdoc.swagger-ui.operations-sorter=method
springdoc.swagger-ui.tags-sorter=alpha
springdoc.swagger-ui.doc-expansion=none
springdoc.swagger-ui.filter=true
springdoc.swagger-ui.show-extensions=true
springdoc.swagger-ui.show-common-extensions=true
springdoc.swagger-ui.try-it-out-enabled=true
springdoc.swagger-ui.persist-authorization=true

# OAuth2 Configuration for Swagger UI
springdoc.swagger-ui.oauth.client-id=${OAUTH2_CLIENT_ID:swagger-ui}
springdoc.swagger-ui.oauth.use-pkce-with-authorization-code-grant=true

# Default group (show users group by default)
springdoc.swagger-ui.urls-primary-name=users

# OAuth2 URLs (used by OpenApiConfig)
springdoc.oauth2.authorization-url=${OAUTH2_AUTHORIZATION_URL:http://localhost:8080/api/auth/authorize}
springdoc.oauth2.token-url=${OAUTH2_TOKEN_URL:http://localhost:8080/api/auth/token}
springdoc.oauth2.refresh-url=${OAUTH2_REFRESH_URL:http://localhost:8080/api/auth/refresh}