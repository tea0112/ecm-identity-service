# Integration Test Configuration for ECM Identity Service
spring.application.name=ecm-identity-service-integration-test

# Database Configuration - will be overridden by Testcontainers
spring.datasource.url=jdbc:postgresql://localhost:5432/ecm_identity_test
spring.datasource.username=test
spring.datasource.password=test
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA configuration for integration tests
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.jdbc.time_zone=UTC

# Disable Flyway for integration tests (let JPA handle schema)
spring.flyway.enabled=false

# Redis Configuration - use embedded Redis for tests
spring.data.redis.host=localhost
spring.data.redis.port=6379
spring.data.redis.timeout=2000ms

# Security Configuration for integration tests
ecm.security.jwt.secret=integration-test-secret-key-for-testing-purposes-only
ecm.security.jwt.access-token-expiration=900000
ecm.security.jwt.refresh-token-expiration=604800000
ecm.security.argon2.memory=65536
ecm.security.argon2.iterations=3
ecm.security.argon2.parallelism=4
ecm.security.rate-limiting.enabled=false

# OAuth2 Authorization Server for integration tests
spring.security.oauth2.authorizationserver.issuer=http://localhost:8080
spring.security.oauth2.authorizationserver.client.ecm-client.registration.client-id=ecm-client
spring.security.oauth2.authorizationserver.client.ecm-client.registration.client-secret={noop}secret
spring.security.oauth2.authorizationserver.client.ecm-client.registration.client-authentication-methods=client_secret_basic,client_secret_post
spring.security.oauth2.authorizationserver.client.ecm-client.registration.authorization-grant-types=authorization_code,refresh_token,client_credentials
spring.security.oauth2.authorizationserver.client.ecm-client.registration.redirect-uris=http://localhost:8080/login/oauth2/code/ecm-client
spring.security.oauth2.authorizationserver.client.ecm-client.registration.scopes=openid,profile,email,read,write

# Multi-tenancy for integration tests
ecm.multitenancy.enabled=true
ecm.multitenancy.default-tenant=test-tenant
ecm.multitenancy.header-name=X-Tenant-ID

# Audit Logging for integration tests
ecm.audit.enabled=true
ecm.audit.crypto-chain.enabled=false
ecm.audit.retention-days=1

# WebAuthn Configuration for integration tests
ecm.webauthn.rp-id=localhost
ecm.webauthn.rp-name=ECM Identity Service Integration Test
ecm.webauthn.rp-origin=http://localhost:8080

# Mail Configuration for integration tests (disabled)
spring.mail.host=localhost
spring.mail.port=25
spring.mail.username=test
spring.mail.password=test
spring.mail.properties.mail.smtp.auth=false
spring.mail.properties.mail.smtp.starttls.enable=false

# Actuator Configuration for integration tests
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=always
management.metrics.export.prometheus.enabled=false

# Logging Configuration for integration tests
logging.level.com.ecm.security.identity=DEBUG
logging.level.org.springframework.security=WARN
logging.level.org.hibernate.SQL=WARN
logging.level.org.testcontainers=INFO
logging.level.org.springframework.test=WARN
logging.pattern.console=%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n
